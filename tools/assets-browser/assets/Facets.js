import{r as e,p as t,j as s,M as a,c as r,a as c,b as l,$ as i,R as n,e as o,d}from"./index.js";import{g as h,b as u}from"./displayUtils.js";const f=e.forwardRef(({onDateRangeChange:c,selectedNumericFilters:l},i)=>{const[n,o]=e.useState(null),[d,h]=e.useState(null);e.useEffect(()=>{if(l.length>0){const{startDate:e,endDate:s}=t(l);e&&!r(e,n)&&o(e),s&&!r(s,d)&&h(s)}},[l,n,d,c]);return e.useImperativeHandle(i,()=>({reset:()=>{o(null),h(null)}})),s.jsx("div",{className:"date-range-filter",children:s.jsx("div",{className:"date-range-wrapper",children:s.jsxs("div",{className:"date-range-inputs",children:[s.jsx("div",{className:"date-range-input-wrapper "+(l.length>0&&n?"has-value":""),children:s.jsx(a,{value:n,onChange:e=>{if(o(e),c){const t=e?new Date(e.year,e.month-1,e.day):void 0,s=d?new Date(d.year,d.month-1,d.day):void 0;c(t,s)}},label:"From","aria-label":"From date",showClearButton:!!n,onClear:()=>{if(o(null),c){const e=d?new Date(d.year,d.month-1,d.day):void 0;c(void 0,e)}}})}),s.jsx("div",{className:"date-range-input-wrapper "+(l.length>0&&d?"has-value":""),children:s.jsx(a,{value:d,onChange:e=>{if(h(e),c){const t=n?new Date(n.year,n.month-1,n.day):void 0,s=e?new Date(e.year,e.month-1,e.day):void 0;c(t,s)}},label:"To","aria-label":"To date",showClearButton:!!d,onClear:()=>{if(h(null),c){const e=n?new Date(n.year,n.month-1,n.day):void 0;c(e,void 0)}}})})]})})})});f.displayName="DateRange";const m=window.location.origin;let v=null;async function p(){return`user:${await async function(){if(v)return v;try{const e=await fetch(`${m}/api/user`,{credentials:"include"}),t=await e.json();return v=t.userId||t.email||"anonymous",v}catch(e){return console.error("Error fetching user ID:",e),v="anonymous",v}}()}:saved-searches`}const g={async load(){var e;try{const t=await p(),s=await fetch(`${m}/api/savedsearches/get?key=${encodeURIComponent(t)}`,{credentials:"include"}),a=await s.json();if(!a.success){if(null==(e=a.error)?void 0:e.includes("not found"))return[];throw new Error(a.error||"Failed to load searches")}return a.value||[]}catch(t){return console.error("Error loading saved searches:",t),[]}},async save(e){try{const t=await p(),s=await fetch(`${m}/api/savedsearches/set`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:t,value:e})}),a=await s.json();if(!a.success)throw new Error(a.error||"Failed to save searches");return!0}catch(t){return console.error("Error saving searches:",t),!1}},async create(e){const t=await this.load(),s=Date.now(),a={id:s.toString(),dateCreated:s,dateLastModified:s,dateLastUsed:s,favorite:!1,...e};return t.push(a),await this.save(t),a},async update(e,t){const s=(await this.load()).map(s=>s.id===e?{...s,...t,dateLastModified:Date.now()}:s);return await this.save(s),s.find(t=>t.id===e)||null},async delete(e){const t=await this.load(),s=t.filter(t=>t.id!==e);return s.length<t.length&&(await this.save(s),!0)},async updateLastUsed(e){return this.update(e,{dateLastUsed:Date.now()})},async toggleFavorite(e){const t=(await this.load()).find(t=>t.id===e);return t?this.update(e,{favorite:!t.favorite}):null},async getById(e){return(await this.load()).find(t=>t.id===e)||null},countFilters(e){let t=0;e.facetFilters&&Object.values(e.facetFilters).forEach(e=>{Object.values(e).forEach(e=>{e&&(t+=1)})});const s=e.numericFilters?e.numericFilters.length:0;return t+s},sortByLastUsed:e=>[...e].sort((e,t)=>{const s=e.dateLastUsed||e.dateLastModified||e.dateCreated||0;return(t.dateLastUsed||t.dateLastModified||t.dateCreated||0)-s}),filter(e,t){if(!t)return e;const s=t.toLowerCase();return e.filter(e=>{const t=e.name.toLowerCase().includes(s),a=(e.searchTerm||"").toLowerCase().includes(s);return t||a})}},b="TCCC.#hierarchy.lvl",x={"tccc-rightsStartDate":{label:"Rights Start Date",type:"date"},"tccc-rightsEndDate":{label:"Rights End Date",type:"date"},"tccc-marketCovered":{label:"Market Covered",type:"checkbox"},"tccc-mediaCovered":{label:"Media Covered",type:"checkbox"}},j=async e=>{try{const t=e.map(e=>({...e,rightsFilters:{rightsStartDate:e.rightsFilters.rightsStartDate?d(e.rightsFilters.rightsStartDate):null,rightsEndDate:e.rightsFilters.rightsEndDate?d(e.rightsFilters.rightsEndDate):null,markets:Array.from(e.rightsFilters.markets),mediaChannels:Array.from(e.rightsFilters.mediaChannels)}}));await g.save(t)}catch(t){console.error("Error saving searches:",t)}},C=n.memo(({facetTechId:e,facet:t,label:a,isExpanded:r,isSearchMode:c,searchTerm:l,checkedCount:i,onToggle:n,onToggleSearch:o,onSearchChange:d,onSearchEscape:h,renderContent:u})=>s.jsxs(s.Fragment,{children:["tccc-rightsStartDate"===e&&s.jsx("div",{className:"facet-rights-section",children:s.jsx("label",{className:"facet-rights-label",children:"Check Rights Filters"})}),s.jsxs("div",{className:"facet-filter-section",children:[c?s.jsxs("div",{className:"facet-filter-button facet-filter-button-search",children:[s.jsx("div",{className:"facet-search-container",children:s.jsxs("div",{className:"facet-search-input-wrapper",children:[s.jsx("img",{src:"/icons/search.svg",alt:"Search",className:"facet-search-icon-inside"}),s.jsx("input",{type:"text",className:"facet-search-input",placeholder:`Search ${a}...`,value:l,autoFocus:!0,onClick:e=>e.stopPropagation(),onChange:t=>d(e,t.target.value),onKeyDown:t=>{"Escape"===t.key&&h(e)}}),s.jsx("img",{src:"/icons/close-menu.svg",alt:"Close",className:"facet-search-close-icon",onClick:t=>o(e,t)})]})}),s.jsxs("div",{className:"facet-filter-right-section",children:[i>0&&s.jsx("div",{className:"assets-details-tag tccc-tag facet-filter-count-tag",children:i}),s.jsx("span",{className:"facet-filter-arrow-top-level "+(r?"expanded":""),onClick:()=>n(e)})]})]}):s.jsxs("div",{className:"facet-filter-button",tabIndex:0,"aria-expanded":r,onClick:()=>n(e),children:[s.jsx("span",{className:"facet-filter-label",children:a}),s.jsxs("div",{className:"facet-filter-right-section",children:[i>0&&s.jsx("div",{className:"assets-details-tag tccc-tag facet-filter-count-tag",children:i}),r&&"date"!==t.type&&s.jsx("img",{src:"/icons/search.svg",alt:"Search",className:"facet-search-trigger",onClick:t=>o(e,t)}),s.jsx("span",{className:"facet-filter-arrow "+(r?"expanded":"")})]})]}),u(e)]})]}));C.displayName="FacetItem";const y=({searchResults:t,search:r,excFacets:n={},selectedNumericFilters:d=[],setSelectedNumericFilters:m,query:v,setQuery:p,searchDisabled:y,setSearchDisabled:S,setIsRightsSearch:N,rightsStartDate:w,setRightsStartDate:k,rightsEndDate:E,setRightsEndDate:D,selectedMarkets:F,setSelectedMarkets:L,selectedMediaChannels:T,setSelectedMediaChannels:O,facetCheckedState:$,setFacetCheckedState:I,onFacetCheckbox:M,onClearAllFacets:U})=>{const[R,A]=e.useState({}),[B,P]=e.useState({}),[W,H]=e.useState({}),[Y,z]=e.useState({}),[V,K]=e.useState({}),q=e.useRef(null),G=e.useRef(!1),J=e.useCallback(e=>{null==k||k(e)},[k]),Q=e.useCallback(()=>{null==k||k(null)},[k]),X=e.useCallback(e=>{null==D||D(e)},[D]),Z=e.useCallback(()=>{null==D||D(null)},[D]),[_,ee]=e.useState("filters"),[te,se]=e.useState([]),[ae,re]=e.useState(!1),[ce,le]=e.useState("");e.useEffect(()=>{(async()=>{try{return(await g.load()).map(e=>({...e,rightsFilters:{rightsStartDate:e.rightsFilters.rightsStartDate?o(e.rightsFilters.rightsStartDate/1e3):null,rightsEndDate:e.rightsFilters.rightsEndDate?o(e.rightsFilters.rightsEndDate/1e3):null,markets:new Set(e.rightsFilters.markets||[]),mediaChannels:new Set(e.rightsFilters.mediaChannels||[])}}))}catch(e){return console.error("Error loading saved searches:",e),[]}})().then(se)},[]);const ie=e.useMemo(()=>{const e={};return null==t||t.forEach(t=>{t.facets&&Object.entries(t.facets).forEach(([t,s])=>{e[t]||(e[t]={}),Object.entries(s).forEach(([s,a])=>{e[t][s]=a})})}),e},[t]),ne=e.useMemo(()=>{const e={};return Object.keys(n).forEach(t=>{var s,a;if(Object.keys(ie||{}).some(e=>e.startsWith(`${t}.${b}`))){const r={};Object.keys(ie||{}).forEach(e=>{if(e.startsWith(`${t}.${b}`)){const t=e.match(/\.lvl(\d+)$/);if(t){const s=parseInt(t[1]);r[s]=ie&&ie[e]}}});const c=null==(a=null==(s=n[t])?void 0:s.sortDirection)?void 0:a.toLowerCase();"asc"!==c&&"desc"!==c||Object.keys(r).forEach(e=>{const t=parseInt(e),s=Object.entries(r[t]).sort(([e],[t])=>{var s,a;const r=(null==(s=e.split(" / ").pop())?void 0:s.trim())||"",l=(null==(a=t.split(" / ").pop())?void 0:a.trim())||"";return"asc"===c?r.localeCompare(l):l.localeCompare(r)});r[t]=Object.fromEntries(s)}),e[t]=r}}),e},[ie,n]),oe=e.useCallback(e=>{A(t=>{const s={...t,[e]:!t[e]};return t[e]&&!s[e]&&(H(t=>({...t,[e]:!1})),z(t=>({...t,[e]:""}))),s})},[]),de=e.useCallback((e,t,s,a)=>{P(r=>{const c={...r},l=r[e];if(c[e]=!l,l&&!c[e]){const e=(e,s)=>{for(let r=s+1;r<10;r++){const s=a[r];s&&Object.keys(s).forEach(s=>{if(s.startsWith(e+" / ")){c[`${t}-${s}`]=!1}})}};let r=1;for(let t=1;t<10;t++){const e=a[t];if(e&&void 0!==e[s]){r=t;break}}e(s,r)}return c})},[]),he=e.useCallback((e,t)=>{t.stopPropagation(),H(t=>({...t,[e]:!t[e]})),W[e]&&z(t=>({...t,[e]:""}))},[W]),ue=e.useCallback((e,t)=>{z(s=>({...s,[e]:t}))},[]),fe=e.useCallback(e=>{H(t=>({...t,[e]:!1})),z(t=>({...t,[e]:""}))},[]),me=e.useCallback((e,t,s)=>{K(a=>({...a,[e]:[t?t.getTime()/1e3:void 0,s?s.getTime()/1e3:void 0]}))},[]),ve=e.useCallback((e,t,s,a,r)=>{if(!a)return!0;const c=a.toLowerCase();if(h(t,s).toLowerCase().includes(c))return!0;for(let l=r+1;l<10;l++){const a=e[l];if(a)for(const[e]of Object.entries(a))if(e.startsWith(s+" / ")){if(h(t,e).toLowerCase().includes(c))return!0}}return!1},[]),pe=e.useCallback((e,t)=>{$[e]&&Object.entries($[e]).forEach(([s,a])=>{!0===a&&(s in t&&0!==t[s]||M(e,s))})},[$,M]),ge=e.useCallback((e,t,a,r="")=>{const c=e[a];if(!c)return[];const l=Y[t]||"",i=[],n=`${t}.${b}${a}`;return pe(n,c),Object.entries(c).forEach(([c,o])=>{var d;const u=c.split(" / "),f=u[u.length-1].trim(),m=h(t,f);if(l&&!ve(e,t,c,l,a))return;const v=u.slice(0,-1).join(" / ");if(1===a||v===r){const r=c,l=`${t}-${c}`,h=e[a+1]&&Object.keys(e[a+1]).some(e=>e.startsWith(r+" / ")),u=["facet-hierarchy-container",a>1?"facet-hierarchy-container-indented":"",h?"facet-hierarchy-container-with-sublevel":""].filter(Boolean).join(" "),f=`${t}-${r}`,v=B[f];i.push(s.jsxs("div",{className:u,children:[s.jsxs("div",{className:"facet-filter-checkbox-label",style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[s.jsxs("label",{className:"facet-filter-checkbox-label",style:{display:"flex",alignItems:"center",gap:"8px",margin:0,cursor:"pointer",flex:1},children:[s.jsx("input",{className:"facet-filter-checkbox-input",type:"checkbox",checked:!!(null==(d=$[n])?void 0:d[c]),onChange:()=>M(n,c)})," ",m,o>0?` (${o})`:""]}),h&&s.jsx("span",{className:"facet-filter-arrow-sub-level caret-icon "+(v?"expanded":""),onClick:()=>de(f,t,r,e)})]}),h&&v&&ge(e,t,a+1,r)]},l))}}),i},[$,M,B,de,Y,ve,pe]),be=e.useCallback(e=>{var t,r;if(!R[e])return null;if("repo-createDate"===e)return s.jsx(f,{ref:q,selectedNumericFilters:d,onDateRangeChange:(t,s)=>me(e,t,s)});if("tccc-rightsStartDate"===e)return s.jsx(a,{className:"rights-date-picker",value:w,onChange:J,label:"From Rights Date","aria-label":"From Rights Date",showClearButton:!!w,onClear:Q});if("tccc-rightsEndDate"===e)return s.jsx(a,{className:"rights-date-picker",value:E,onChange:X,label:"To Rights Date","aria-label":"To Rights Date",showClearButton:!!E,onClear:Z});if("tccc-marketCovered"===e)return s.jsx(c,{includeSearchBox:!1,selectedMarkets:F,setSelectedMarkets:L});if("tccc-mediaCovered"===e)return s.jsx(l,{selectedMediaChannels:T,setSelectedMediaChannels:O});const i=ne[e];if(!!i)return s.jsx("div",{className:"facet-filter-checkbox-list",children:ge(i,e,1)});if(!R[e]||!ie||!ie[e]||0===Object.keys(ie[e]||{}).length)return null;const o=Y[e]||"",u=`${e}`,m=ie&&ie[e]||{};pe(u,m);let v=Object.entries(m).filter(([t])=>{if(!o)return!0;return h(e,t).toLowerCase().includes(o.toLowerCase())});const p=null==(r=null==(t=n[e])?void 0:t.sortDirection)?void 0:r.toLowerCase();return"asc"!==p&&"desc"!==p||(v=v.sort(([t],[s])=>{const a=h(e,t),r=h(e,s);return"asc"===p?a.localeCompare(r):r.localeCompare(a)})),s.jsx("div",{className:"facet-filter-checkbox-list",children:v.map(([t,a])=>{var r;const c=h(e,t);return s.jsxs("label",{className:"facet-filter-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:!!(null==(r=$[u])?void 0:r[t]),onChange:()=>M(u,t)})," ",c,a>0?` (${a})`:""]},t)})})},[n,R,d,me,ne,ge,ie,$,M,Y,Q,J,w,Z,X,E,F,T,L,O,pe]);e.useEffect(()=>{Object.keys(V).length>0&&setTimeout(()=>{m(Object.entries(V).flatMap(([e,t])=>{const s=[];return void 0!==t[0]&&s.push(`${e} >= ${t[0]}`),void 0!==t[1]&&s.push(`${e} <= ${t[1]}`),s}))},0)},[V,m]);const xe=e.useCallback(e=>{let t=0;return Object.entries($).forEach(([s,a])=>{(s===e||s.startsWith(`${e}.`))&&Object.values(a).forEach(e=>{e&&t++})}),t},[$]),je=e.useCallback(()=>{let e=0;return Object.values($).forEach(t=>{Object.values(t).forEach(t=>{t&&e++})}),e},[$]),Ce=e.useCallback(()=>{var e;G.current=!0,I({}),m([]),null==k||k(null),null==D||D(null),L(new Set),O(new Set),K({}),A({}),P({}),H({}),z({}),null==(e=q.current)||e.reset()},[I,m,k,D,L,O]);e.useEffect(()=>{null==U||U(Ce)},[Ce,U]);const ye=e.useCallback(()=>{r()},[r]),Se=e.useMemo(()=>{const e=!!w,t=!!E,s=e&&t,a=e||t,r=F.size>0||T.size>0||a,c=F.size>0&&T.size>0&&s;return{isNone:!r,isIncomplete:r&&!c,isComplete:c}},[F,T,w,E]);e.useEffect(()=>{null==N||N(Se.isComplete)},[Se.isComplete,N]),e.useEffect(()=>{if(S){const e="filters"===_&&Se.isIncomplete;S(e)}},[Se.isIncomplete,S,_]);const Ne=e.useCallback(()=>{var e;if(ce.trim()){const s=window.location.pathname;let a="/search/all";s.includes("/search/assets")?a="/search/assets":s.includes("/search/products")?a="/search/products":s.includes("/search/all")&&(a="/search/all");const r={rightsStartDate:w,rightsEndDate:E,markets:new Set(F),mediaChannels:new Set(T)};let c;if(t&&(null==(e=t[0])?void 0:e.hits)&&t[0].hits.length>0){c=t[0].hits[0].assetId}const l=Date.now(),n={id:l.toString(),name:ce.trim(),searchTerm:v,facetFilters:$,numericFilters:[...d],rightsFilters:r,dateCreated:l,dateLastModified:l,dateLastUsed:l,favorite:!1,searchType:a,thumbnailImageId:c},o=[...te,n];se(o),j(o),i.positive("SEARCH SAVED SUCCESSFULLY",{timeout:3e3}),le(""),re(!1)}},[ce,F,T,w,E,v,$,d,te,t]),we=()=>{le(""),re(!1)},ke=()=>{Ye(null)},Ee=e=>{if(!e)return"Never used";const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/864e5);return 0===a?"Today":1===a?"Yesterday":a<7?`${a} days ago`:t.toLocaleDateString()},[De,Fe]=e.useState(!1),[Le,Te]=e.useState(""),[Oe,$e]=e.useState(""),[Ie,Me]=e.useState(null),[Ue,Re]=e.useState(!1),[Ae,Be]=e.useState(null),[Pe,We]=e.useState(""),[He,Ye]=e.useState(null),[ze,Ve]=e.useState({x:0,y:0}),Ke=e.useCallback(()=>{var e;if(!Ie)return void Fe(!1);const s={rightsStartDate:w,rightsEndDate:E,markets:new Set(F),mediaChannels:new Set(T)};let a;if(t&&(null==(e=t[0])?void 0:e.hits)&&t[0].hits.length>0){const e=t[0].hits[0];a=e.assetId}const r=Date.now(),c=te.map(e=>e.id===Ie?{...e,name:Oe.trim()||e.name,searchTerm:v,facetFilters:$,numericFilters:[...d],rightsFilters:s,dateLastModified:r,thumbnailImageId:a}:e);se(c),j(c),i.positive("SAVED SEARCH UPDATED SUCCESSFULLY",{timeout:3e3}),Fe(!1),Te(""),$e(""),Me(null)},[Ie,F,T,w,E,v,$,d,te,Oe,t]);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"facet-filter-container",children:s.jsxs("div",{className:"facet-filter",children:[s.jsx("div",{className:"facet-filter-header",children:s.jsxs("div",{className:"facet-filter-tabs",children:[s.jsxs("div",{className:"facet-filter-tab-group left "+("filters"===_?"active":""),onClick:()=>ee("filters"),style:{cursor:"pointer"},children:[s.jsxs("button",{className:"facet-filter-tab "+("filters"===_?"active":""),onClick:()=>ee("filters"),type:"button",children:["Filters",je()>0&&s.jsx("div",{className:"assets-details-tag tccc-tag facet-filter-count-tag",children:je()})]}),s.jsx("button",{className:"facet-filter-tab clear",onClick:e=>{ee("filters"),e.stopPropagation(),Ce()},type:"button",children:"CLEAR ALL"})]}),s.jsx("div",{className:"facet-filter-tab-group right "+("saved"===_?"active":""),onClick:()=>ee("saved"),style:{cursor:"pointer"},children:s.jsx("button",{className:"facet-filter-tab "+("saved"===_?"active":""),onClick:()=>ee("saved"),type:"button",children:"My Saved Searches"})})]})}),"filters"===_?s.jsx("div",{className:"facet-filter-list",children:[...Object.entries(n).filter(([e])=>!Object.keys(x).includes(e)),...Object.entries(x)].map(([e,t])=>{const a=t.label||e,r=xe(e);return s.jsx(C,{facetTechId:e,facet:t,label:a,isExpanded:!!R[e],isSearchMode:!!W[e],searchTerm:Y[e]||"",checkedCount:r,onToggle:oe,onToggleSearch:he,onSearchChange:ue,onSearchEscape:fe,renderContent:be},e)})}):s.jsx("div",{className:"saved-searches-list",children:0===te.length?s.jsxs("div",{className:"saved-searches-empty",children:[s.jsx("p",{children:"No saved searches yet."}),s.jsx("p",{children:'Switch to Filters tab and click "Save Search" to save your first search.'})]}):[...te].sort((e,t)=>{const s=e.favorite?1:0,a=t.favorite?1:0;if(a!==s)return a-s;const r=e.dateLastUsed??0;return(t.dateLastUsed??0)-r}).map(e=>s.jsx("div",{className:"saved-search-item",onMouseEnter:t=>((e,t)=>{Ye(e);const s=t.currentTarget.getBoundingClientRect();Ve({x:s.left+s.width/2,y:s.top-10})})(e.id,t),onMouseLeave:ke,children:s.jsxs("div",{className:"saved-search-info",children:[s.jsxs("div",{className:"saved-search-title",children:[s.jsx("button",{className:"saved-search-name-link",type:"button",onClick:t=>{(e=>{if(e.searchType&&!window.location.pathname.includes(e.searchType)){const t=u(e);return void(window.location.href=t)}ke(),Ce();const t=e.searchTerm||"";p(t),setTimeout(()=>{G.current=!0,I(e.facetFilters),m(e.numericFilters),e.rightsFilters&&(null==k||k(e.rightsFilters.rightsStartDate),null==D||D(e.rightsFilters.rightsEndDate),L(new Set(e.rightsFilters.markets)),O(new Set(e.rightsFilters.mediaChannels))),ee("filters");const t=Date.now(),s=te.map(s=>s.id===e.id?{...s,dateLastUsed:t}:s);se(s),j(s)},0)})(e),t.currentTarget.blur()},title:"Load this saved search",children:e.name}),s.jsx("button",{className:"saved-search-fav-btn "+(e.favorite?"favorite":""),title:"Favorite",onClick:t=>{const s=te.map(t=>t.id===e.id?{...t,favorite:!t.favorite}:t);se(s),j(s),t.currentTarget.blur()},type:"button",children:s.jsx("img",{src:e.favorite?"/tools/assets-browser/icons/star-yellow.svg":"/tools/assets-browser/icons/star-grey.svg",alt:"Favorite"})})]}),s.jsxs("div",{className:"saved-search-actions-left",children:[s.jsx("button",{className:"saved-search-icon-btn",title:"Copy",onClick:t=>{(async e=>{try{const t=u(e);await navigator.clipboard.writeText(t);const s=Date.now(),a=te.map(t=>t.id===e.id?{...t,dateLastUsed:s}:t);se(a),j(a),i.positive("SAVED SEARCH COPIED SUCCESSFULLY",{timeout:3e3})}catch(t){console.warn("[SavedSearch] clipboard copy failed, falling back to prompt"),window.prompt("Copy this link",u(e));const a=Date.now(),r=te.map(t=>t.id===e.id?{...t,dateLastUsed:a}:t);se(r),j(r),i.positive("SAVED SEARCH COPIED SUCCESSFULLY",{timeout:3e3})}})(e),t.currentTarget.blur()},type:"button",children:s.jsx("img",{src:"/tools/assets-browser/icons/copy-circle.svg",alt:"Copy"})}),s.jsx("button",{className:"saved-search-icon-btn",title:"Edit",onClick:t=>{(e=>{const t=u(e);Te(t),$e(e.name),Me(e.id),Fe(!0)})(e),t.currentTarget.blur()},type:"button",children:s.jsx("img",{src:"/tools/assets-browser/icons/edit-circle.svg",alt:"Edit"})}),s.jsx("button",{className:"saved-search-delete-btn",onClick:t=>{(e=>{const t=te.find(t=>t.id===e),s=(null==t?void 0:t.name)||"this saved search";Be(e),We(s),Re(!0)})(e.id),t.currentTarget.blur()},type:"button",title:"Delete",children:s.jsx("img",{src:"/tools/assets-browser/icons/delete-circle.svg",alt:"Delete"})})]})]})},e.id))})]})}),De&&s.jsx("div",{className:"save-search-modal",children:s.jsxs("div",{className:"save-search-modal-content",children:[s.jsx("div",{className:"save-search-modal-header",children:s.jsx("h3",{children:"Edit Saved Search"})}),s.jsxs("div",{className:"save-search-modal-body",children:[s.jsxs("div",{className:"save-search-field",children:[s.jsx("label",{htmlFor:"edit-search-name",className:"save-search-field-label",children:"Search Name:"}),s.jsx("input",{id:"edit-search-name",type:"text",value:Oe,onChange:e=>$e(e.target.value),className:"save-search-input",placeholder:"Enter search name",autoFocus:!0})]}),s.jsxs("div",{className:"save-search-field",children:[s.jsx("label",{className:"save-search-field-label",children:"Generated Link:"}),s.jsx("textarea",{className:"save-search-input save-search-link-display",value:Le,readOnly:!0,rows:4})]})]}),s.jsxs("div",{className:"save-search-modal-footer",children:[s.jsx("button",{className:"save-search-cancel-btn",onClick:()=>{Fe(!1),Te(""),$e(""),Me(null)},type:"button",children:"Cancel"}),s.jsx("button",{className:"save-search-confirm-btn",onClick:Ke,type:"button",disabled:!Oe.trim(),children:"Update"})]})]})}),Ue&&s.jsx("div",{className:"save-search-modal",children:s.jsxs("div",{className:"save-search-modal-content",children:[s.jsx("div",{className:"save-search-modal-header",children:s.jsx("h3",{children:"Delete Saved Search"})}),s.jsx("div",{className:"save-search-modal-body",children:s.jsxs("p",{children:['Are you sure you want to delete "',s.jsx("strong",{children:Pe}),'"?']})}),s.jsxs("div",{className:"save-search-modal-footer",children:[s.jsx("button",{className:"save-search-cancel-btn",onClick:()=>{Re(!1),Be(null),We("")},type:"button",children:"Cancel"}),s.jsx("button",{className:"delete-search-confirm-btn",onClick:()=>{if(Ae){const e=te.filter(e=>e.id!==Ae);se(e),j(e),i.positive("SAVED SEARCH DELETED SUCCESSFULLY",{timeout:3e3})}Re(!1),Be(null),We("")},type:"button",children:"Delete"})]})]})}),He&&s.jsx("div",{className:"saved-search-tooltip",style:{position:"fixed",left:`${ze.x}px`,top:`${ze.y}px`,transform:"translate(-50%, -100%)",pointerEvents:"none",zIndex:1001},children:(()=>{const e=te.find(e=>e.id===He);return e?s.jsxs("div",{className:"tooltip-content",children:[s.jsx("div",{className:"tooltip-search-terms",children:e.searchTerm||"No search terms"}),s.jsx("div",{className:"tooltip-filter-count",children:(()=>{const t=(e=>{let t=0;Object.values(e.facetFilters).forEach(e=>{Object.values(e).forEach(e=>{e&&t++})});const s=e.numericFilters.length;return t+s})(e);return 0===t?"No filters":1===t?"1 filter":`${t} filters`})()}),s.jsxs("div",{className:"tooltip-last-used",children:["Last used: ",Ee(e.dateLastUsed)]})]}):null})()}),"filters"===_&&ae&&s.jsx("div",{className:"save-search-inline-form",children:s.jsxs("div",{className:"save-search-inline-input-container",children:[s.jsx("input",{type:"text",placeholder:"name for your saved search",value:ce,onChange:e=>le(e.target.value),className:"save-search-inline-input",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key?Ne():"Escape"===e.key&&we()}}),s.jsx("button",{className:"save-search-inline-save-btn",type:"button",onClick:Ne,disabled:!ce.trim(),children:"Save"})]})}),"filters"===_&&s.jsxs(s.Fragment,{children:[(y||Se.isIncomplete)&&s.jsx("div",{className:"rights-validation-warning",children:"Select all rights parameters to enable the Apply button"}),s.jsxs("div",{className:"facet-filter-buttons",children:[s.jsxs("button",{className:"facet-filter-apply-btn",type:"button",disabled:y||Se.isIncomplete,onClick:ae?we:ye,children:[s.jsx("span",{className:"facet-filter-apply-icon",children:s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("polygon",{points:"3 4 21 4 14 14 14 21 10 21 10 14 3 4"})})}),s.jsx("span",{className:"facet-filter-apply-text",children:"Apply"})]}),s.jsxs("button",{className:"facet-filter-save-btn "+(ae?"cancel-mode":""),type:"button",onClick:ae?we:()=>{re(!0)},children:[s.jsx("span",{className:"facet-filter-save-icon",children:s.jsx("img",{src:"/tools/assets-browser/icons/save-icon.svg",alt:"Save"})}),s.jsx("span",{className:"facet-filter-save-text",children:ae?"Cancel":"Save Search"})]})]})]})]})};export{y as default};
//# sourceMappingURL=Facets.js.map
